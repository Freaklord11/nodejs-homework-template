"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7555],{561441:function(e,t,s){s.d(t,{Z:function(){return S}});var n=s(824246),r=s(679892),i=s.n(r),a=s(827378),o=s(881620),c=s(802638),d=s(298784),l=s.n(d),p=s(194892),u=s(808704),h=s(64499),m=s(513473),b=s(711877),x=s(285556);function g(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function f(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function a(e){g(i,n,r,a,o,"next",e)}function o(e){g(i,n,r,a,o,"throw",e)}a(void 0)}))}}var y=({benchmarkId:e,updateBenchmarkState:t,passed:s=!1})=>{const{0:r,1:i}=(0,a.useState)(!1),{0:o,1:c}=(0,a.useState)([]),{0:d,1:p}=(0,a.useState)(!1),u=function(){var s=f((function*(){try{yield(0,x.ZP)(null,`internal/training/approve/${e}`,{method:"POST"}),t&&t(),p(!0),alert("Successfully approved benchmark: "+e)}catch(s){(0,x.vj)(s),alert("Failed to approve benchmark: "+e)}}));return function(){return s.apply(this,arguments)}}();(0,a.useEffect)((()=>{let t=!1;const s=function(){var s=f((function*(){const{attempts:s,isCreator:n}=yield(0,x.ZP)(null,"/corp-api/qm/individual-benchmark-metrics/attempts-since-last-update",{method:"POST",body:{scenarioId:e}});t||(c(s),i(n))}));return function(){return s.apply(this,arguments)}}();return s(),()=>{t=!0}}),[e]);const h=!r&&(1===o.length&&o[0].accuracy>=1||s);return(0,n.jsx)(b.u,{text:r?"You cannot approve your own benchmark. Please ask a teammate to verify it.":d?"This benchmark has been approved.":0===o.length?"Please attempt the benchmark to verify it.":l().every(o,(e=>e.accuracy<1))?"Attempts didn't meet the pass threshold. You can't verify this benchmark.":o.length>1?"Benchmarks must be passed on the first attempt to be verified, but you have multiple attempts on this benchmark.":"Approve this benchmark",target:(0,n.jsx)("div",{children:(0,n.jsx)(b.zx,{onClick:()=>u(),disabled:!h||d,variant:"primary",children:d?"Approved":"Approve Benchmark"})})})},k=s(213282);function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const w=[u.GraderBuckets.Missing,u.GraderBuckets.Extraneous,u.GraderBuckets.Incorrect];class v extends a.Component{get graderResponse(){return this.props.submissionResponse.graderResponse}renderTrainingAttemptId(){return(0,n.jsx)("div",{children:`Training Attempt Id: ${this.props.trainingAttempt}`},"trainingAttemptId")}renderGlobalErrorScores(){var e;if(!(null===(e=this.graderResponse)||void 0===e?void 0:e.globalErrorScores))return;const t=this.graderResponse.globalErrorScores,s=l().map(t,(e=>{var t;const s=e.intermediates&&l().size(e.intermediates)>1,r=e.correctWork!==e.totalWork,i=0!==(null===e||void 0===e||null===(t=e.graderConfig)||void 0===t?void 0:t.defaultWeight);if(r&&i){let t=(0,u.getErrorCategoryName)(e);const r=e.intermediates||0;return!s&&r&&(t+=" (",t+=l().map(r,((e,t)=>`${t}: ${l().isNumber(e)&&!l().isInteger(e)?e.toFixed(2):e}`)).join(", "),t+=")"),(0,n.jsx)("li",{children:t})}}));return 0!==s.length?(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Summary"}),(0,n.jsx)("ul",{children:s})]},"globalErrorScores"):void 0}getChatSubmittedAndExpectedResponse(e){let t=(0,m.Hm)(l().get(e,"currentAnnotation.frames[0]")),s=(0,m.Hm)(l().get(e,"correctAnnotation.frames[0]"));return t=void 0===t?"(missing)":`${t}`,s=`${s}`,{yourResponse:t,expected:s}}renderMatchedErrorScoresChat(){var e,t,s;const r=null===(e=this.props.trainingScenario)||void 0===e?void 0:e.params;if(!r)return null;const o=[...r.before,...r.turn,...r.after];if(!(null===(t=this.graderResponse)||void 0===t?void 0:t.matchedAnnotationsList))return null;const c=this.props.submissionResponse.passedAccuracyBar&&this.props.submissionResponse.passedSpeedBar,d=this.graderResponse.matchedAnnotationsList,p=(null===(s=this.props.trainingScenario.graderParams)||void 0===s?void 0:s.perAnnotationFeedback)||{},h=(0,u.getBucketedGradedAnnotations)(d,p),m={};var b;m[u.GraderBuckets.Missing]=this.graderResponse.matchedAnnotationsList.filter((e=>e.correctAnnotation)).length,m[u.GraderBuckets.Incorrect]=this.graderResponse.matchedAnnotationsList.filter((e=>e.correctAnnotation)).map((e=>{var t;return null!==(b=null===(t=e.scores)||void 0===t?void 0:t.filter((e=>!["missing","extraneous"].includes(e.graderType))).filter((e=>{var t;return 0!==(null===(t=e.graderConfig)||void 0===t?void 0:t.defaultWeight)})).length)&&void 0!==b?b:0})).reduce(((e,t)=>e+t),0);const x={};return x[u.GraderBuckets.Missing]=h[u.GraderBuckets.Missing].length,x[u.GraderBuckets.Incorrect]=h[u.GraderBuckets.Incorrect].map((e=>{var t;return(null===(t=e.errors)||void 0===t?void 0:t.length)||0})).reduce(((e,t)=>e+t),0),(0,n.jsxs)(a.Fragment,{children:[l().map(w,(e=>{if(l().isNil(h)||l().isEmpty(h[e]))return null;const t=h[e];return(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket",children:[this.props.trainingScenario.feedbackMessage&&(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4 "+((c?"feedbackMessage":"feedbackMessageFail")||""),children:[(0,n.jsx)("div",{className:"jsx-81fa3863ed7808a4 bucket-name",children:"Feedback"}),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:k.ZP.render(this.props.trainingScenario.feedbackMessage)},className:"jsx-81fa3863ed7808a4"})]}),m[e]&&(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket-totals",children:[x[e]," errors"]}),(0,n.jsx)("div",{className:"jsx-81fa3863ed7808a4",children:l().map(t,(e=>{const t=l().get(e,"currentAnnotation.frames[0].chatTaskAnnotationMetadata");let s=l().get(e,"metadata.props.label");if(t){var r;const e=t.stepId,n=o.find((t=>t.id===e)),i=null===(r=l().get(n,"params.fields",[]).find((e=>e.field_id===t.originalFieldId)))||void 0===r?void 0:r.title;n&&n.title&&(s=`${n.title} | Response#: ${t.responseIndex+1}${void 0===t.candidateIndex?"":` | Candidate#: ${t.candidateIndex+1}`}${void 0===t.originalFieldId?"":` | Field: ${null!==i&&void 0!==i?i:t.originalFieldId}`}`)}if(!s)return null;const{yourResponse:i,expected:a}=this.getChatSubmittedAndExpectedResponse(e);return(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket-item",children:[(0,n.jsx)("div",{className:"jsx-81fa3863ed7808a4 bucket-item-name",children:s}),(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4",children:["Your response: ",i]}),(0,n.jsxs)("div",{className:"jsx-81fa3863ed7808a4",children:["Expected: ",a]})]},s)}))})]},e)})),(0,n.jsx)(i(),{id:"81fa3863ed7808a4",children:".feedbackMessage.jsx-81fa3863ed7808a4{padding:8px;font-size:14px;border:1px solid#19b629;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;margin-bottom:12px}.feedbackMessageFail.jsx-81fa3863ed7808a4{padding:8px;font-size:14px;border:1px solid#ec322f;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;margin-bottom:12px}.bucket.jsx-81fa3863ed7808a4{padding:16px;font-size:14px}.bucket-name.jsx-81fa3863ed7808a4{letter-spacing:.5px;font-weight:500;opacity:.5}.bucket-totals.jsx-81fa3863ed7808a4{margin-top:4px;font-weight:500}.bucket-item.jsx-81fa3863ed7808a4{margin:16px 0}.bucket-item-name.jsx-81fa3863ed7808a4{margin-bottom:8px;font-weight:500}.bucket-errors.jsx-81fa3863ed7808a4{margin-left:16px}"})]})}renderGraderResponse(){const e=new URLSearchParams(window.location.search),t=e.get("trainingId");var s;const r=null!==(s=Boolean(e.get("isVerificationAttempt")))&&void 0!==s&&s,a=1===this.props.submissionResponse.accuracy&&1===this.props.submissionResponse.numAttempts;return(0,n.jsxs)("div",{className:"jsx-2b3bd2a18eb650f2 grader-response branded-scroll--neutral",children:[(0,n.jsxs)("div",{className:"jsx-2b3bd2a18eb650f2 grader-response-header scale-tailwind scale-theme scaleui flex flex-row items-center space-x-2",children:[!a&&"Error Summary",r&&t&&a&&(0,n.jsx)(y,{benchmarkId:t,passed:a})]}),this.renderGlobalErrorScores(),this.renderMatchedErrorScoresChat(),(0,n.jsx)(i(),{id:"2b3bd2a18eb650f2",children:".grader-response.jsx-2b3bd2a18eb650f2{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:480px;overflow:auto;background:white;border-top:1px solid var(--color-RemoGray01);border-left:1px solid var(--color-RemoGray01);font-size:15px}.grader-response-header.jsx-2b3bd2a18eb650f2{height:52px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid var(--color-RemoGray01);font-weight:500}.grader-response-explanation.jsx-2b3bd2a18eb650f2{padding:0 16px;margin-bottom:8px;font-weight:400;font-style:italic}"})]})}get perfDisplay(){var e,t,s;const{passedAccuracyBar:r,passedSpeedBar:i,timeSpentSecs:a,accuracy:o,passedBar:c,throttleTimeMs:d,isSpotterEvaluation:p}=this.props.submissionResponse,u=null===(e=this.props.trainingScenario)||void 0===e||null===(t=e.params)||void 0===t||null===(s=t.spotterBenchmarkParams)||void 0===s?void 0:s.expectedOutcome,{isInstructiveBenchmark:m,isConditionallyInstructiveBenchmark:b,isConditionallyInstructiveBenchmarkPassed:x}=this.props,g=r&&i,f=`${(100*Math.max(0,o)).toFixed(2)}%`,y="#19B629",k="#F2C94C",j="#EC322F",w=d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:(0,n.jsx)("u",{children:(0,h._W)(d)})})})]}):"";let v,S;if(m)1===o||b&&x?(S=y,v=p?(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["You correctly ",u," this task!"]})," Great work!"," "]}):(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",f,"!"]})," Great work!"," "]})):c?(S=k,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",f,"."]})," Pretty good!"," "]})):(S=j,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",f,"."]})," "]}));else if(g)S=y,v=(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge. Your response was ",f," accurate."]});else if(r){const e=`${Math.floor(a/60)}:${l().padStart(Math.floor(a%60).toString(),2,"0")}`;S=k,v=(0,n.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,n.jsx)("strong",{children:e})," wasn't quite fast enough.",w]})}else S=j,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your response was ",f," accurate."]})," ","Take a look at the error summary to see why.",w]});return{message:v,color:S}}get ctaButtons(){const{passedAccuracyBar:e,passedSpeedBar:t,accuracy:s,submitted:r,throttleTimeMs:c}=this.props.submissionResponse,{backToQueue:d,isInstructiveBenchmark:l,showFixAnswer:p,isConditionallyInstructiveBenchmark:u,isConditionallyInstructiveBenchmarkPassed:h,simpleFeedbackModalClosing:m}=this.props,b=e&&t,x=u&&h;return(0,n.jsxs)("div",{className:"jsx-9966e1d7a541c6b cta-buttons",children:[m?(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Close"})}):(0,n.jsx)(a.Fragment,{children:c&&!u?(0,n.jsx)("div",{className:"jsx-9966e1d7a541c6b cta-button primary",children:(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:(0,n.jsx)("span",{style:{color:"white"},className:"jsx-9966e1d7a541c6b",children:"Back to Onboarding Center"})})}):(0,n.jsxs)(n.Fragment,{children:[l&&(0,n.jsx)(a.Fragment,{children:1===s||r||x?(0,n.jsx)("div",{onClick:d,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Back to Queue"}):(0,n.jsx)("div",{onClick:d,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})}),!l&&!b&&(0,n.jsxs)(a.Fragment,{children:[t&&(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button secondary",children:"Clear & Restart"}),p&&(0,n.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})]}),!t&&(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button primary",children:"Retry"})})]})]})}),(0,n.jsx)(i(),{id:"9966e1d7a541c6b",children:".cta-buttons.jsx-9966e1d7a541c6b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-9966e1d7a541c6b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-9966e1d7a541c6b+.cta-button.jsx-9966e1d7a541c6b{margin-left:16px}.cta-button.primary.jsx-9966e1d7a541c6b{padding:4px 12px;font-weight:500;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-9966e1d7a541c6b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-9966e1d7a541c6b{padding:4px 0px;background:none;font-weight:normal}"})]})}renderMultiTaskResponse(){const e=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){j(e,t,s[t])}))}return e}({},this.props.trainingScenario,{attemptId:this.props.trainingAttempt||this.props.trainingScenario._id,instruction:this.props.trainingScenario.instructions});return(0,n.jsx)(p.Z,{subtask:e,responses:[this.props.responses[0]]})}renderHeader(){return(0,n.jsxs)("div",{style:{background:this.perfDisplay.color},className:"jsx-73684222cea1b66 header",children:[(0,n.jsx)("div",{className:"jsx-73684222cea1b66",children:this.perfDisplay.message}),this.props.isCorpUser&&this.renderTrainingAttemptId(),(0,n.jsx)("div",{className:"jsx-73684222cea1b66",children:this.ctaButtons}),(0,n.jsx)(i(),{id:"73684222cea1b66",children:".header.jsx-73684222cea1b66{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}"})]})}renderRedirect(){const e=new URLSearchParams(window.location.search);if(e.has("course_url")){const t=decodeURIComponent(e.get("course_url"));return(0,n.jsx)(o.ZP,{href:t,children:"Continue Your Course"})}return(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"})}renderBody(){return(0,n.jsxs)(a.Fragment,{children:[this.renderMultiTaskResponse(),this.renderGraderResponse()]})}render(){const e=this.props.submissionResponse.passedAccuracyBar&&this.props.submissionResponse.passedSpeedBar;return(0,n.jsxs)(c.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[(0,n.jsxs)("div",{className:"jsx-fc10bd11042c7e26 container",children:[(0,n.jsx)("div",{className:"jsx-fc10bd11042c7e26 feedback-header",children:this.renderHeader()}),e&&!this.props.simpleFeedbackModalClosing&&(0,n.jsx)("div",{className:"jsx-fc10bd11042c7e26 redirect-header",children:this.renderRedirect()}),(0,n.jsx)("div",{className:"jsx-fc10bd11042c7e26 feedback-body",children:this.renderBody()})]}),(0,n.jsx)(i(),{id:"fc10bd11042c7e26",children:".container.jsx-fc10bd11042c7e26{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.feedback-header.jsx-fc10bd11042c7e26{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.redirect-header.jsx-fc10bd11042c7e26{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden;padding:10px;margin:auto}.feedback-body.jsx-fc10bd11042c7e26{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:scroll}"})]})}}v.defaultProps={showFixAnswer:!0};var S=v},13848:function(e,t,s){var n=s(824246),r=s(679892),i=s.n(r),a=s(827378),o=s(881620),c=s(802638),d=s(298784),l=s.n(d),p=s(167469),u=s(194892),h=s(245203),m=s(64499);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class x extends a.Component{get graderResponse(){return this.props.submissionResponse.graderResponse}renderTrainingAttemptId(){return(0,n.jsx)("div",{children:`Training Attempt Id: ${this.props.trainingAttempt}`},"trainingAttemptId")}get perfDisplay(){const{passedAccuracyBar:e,passedSpeedBar:t,timeSpentSecs:s,accuracy:r,passedBar:i,throttleTimeMs:a}=this.props.submissionResponse,{isInstructiveBenchmark:o,allowedToSeeAnswerKey:c,isConditionallyInstructiveBenchmark:d,isConditionallyInstructiveBenchmarkPassed:u}=this.props,{params:h,taskType:b}=this.props.trainingScenario,x=e&&t,g=`${(100*Math.max(0,r)).toFixed(2)}%`,f="#008EFF",y="#19B629",k="#F2C94C",j="#EC322F",w=a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:(0,n.jsx)("u",{children:(0,m._W)(a)})})})]}):"";let v,S;if(!1===h.showGrade)S=f,v=(0,n.jsxs)("span",{children:["Review all of your errors to see how well you did. Ask a trainer or on Slack when you are not sure.",w]});else if(o){const e=b===p.TaskType.SegmentAnnotation;1===r||e&&r>=.5||d&&u?(S=y,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",g,"!"]})," Great work!"," "]})):i?(S=k,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",g,"."]})," Pretty good!",c&&"Take a look at the Answer Key to identify issues to improve on."]})):(S=j,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",g,"."]}),c&&"Take a look at the Answer Key to identify issues to improve on."]}))}else if(x)S=y,v=(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(e){const e=`${Math.floor(s/60)}:${l().padStart(Math.floor(s%60).toString(),2,"0")}`;S=k,v=(0,n.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,n.jsx)("strong",{children:e})," wasn't quite fast enough.",w]})}else S=j,v=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your response was ",g," accurate."]})," ",c&&"Take a look at the Answer Key to identify issues.",w]});return{message:v,color:S}}get ctaButtons(){const{passedAccuracyBar:e,passedSpeedBar:t,accuracy:s,submitted:r,throttleTimeMs:c}=this.props.submissionResponse,{backToQueue:d,isInstructiveBenchmark:l,isConditionallyInstructiveBenchmark:p,isConditionallyInstructiveBenchmarkPassed:u,simpleFeedbackModalClosing:h}=this.props,m=e&&t,b=p&&u;return(0,n.jsxs)("div",{className:"jsx-9966e1d7a541c6b cta-buttons",children:[h?(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Close"})}):(0,n.jsx)(a.Fragment,{children:c&&!p?(0,n.jsx)("div",{className:"jsx-9966e1d7a541c6b cta-button primary",children:(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:(0,n.jsx)("span",{style:{color:"white"},className:"jsx-9966e1d7a541c6b",children:"Back to Onboarding Center"})})}):(0,n.jsxs)(n.Fragment,{children:[l&&(0,n.jsx)(a.Fragment,{children:1===s||r||b?(0,n.jsx)("div",{onClick:d,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Back to Queue"}):(0,n.jsx)("div",{onClick:d,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})}),!l&&!m&&(0,n.jsxs)(a.Fragment,{children:[t&&(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button secondary",children:"Clear & Restart"}),(0,n.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})]}),!t&&(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:this.props.retryTraining,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Retry"})})]})]})}),(0,n.jsx)(i(),{id:"9966e1d7a541c6b",children:".cta-buttons.jsx-9966e1d7a541c6b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-9966e1d7a541c6b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-9966e1d7a541c6b+.cta-button.jsx-9966e1d7a541c6b{margin-left:16px}.cta-button.primary.jsx-9966e1d7a541c6b{padding:4px 12px;font-weight:500;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-9966e1d7a541c6b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-9966e1d7a541c6b{padding:4px 0px;background:none;font-weight:normal}"})]})}renderMultiTaskResponse(){const e=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){b(e,t,s[t])}))}return e}({},this.props.trainingScenario,{instruction:this.props.trainingScenario.instructions});if(!this.props.allowedToSeeAnswerKey)return(0,n.jsx)(h.Z,{subtask:e,responses:[this.props.responses[0]]});const t=[...this.props.responses];return this.props.diffingResponse&&t.push(...this.props.diffingResponse),(0,n.jsx)(u.Z,{subtask:e,responses:t,diffingResponse:this.props.diffingResponse,diffingResponseName:"Problem Zones"})}renderHeader(){return(0,n.jsxs)("div",{style:{background:this.perfDisplay.color},className:"jsx-73684222cea1b66 header",children:[(0,n.jsx)("div",{className:"jsx-73684222cea1b66",children:this.perfDisplay.message}),this.props.isCorpUser&&this.renderTrainingAttemptId(),(0,n.jsx)("div",{className:"jsx-73684222cea1b66",children:this.ctaButtons}),(0,n.jsx)(i(),{id:"73684222cea1b66",children:".header.jsx-73684222cea1b66{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}"})]})}renderRedirect(){const e=new URLSearchParams(window.location.search);if(e.has("course_url")){const t=decodeURIComponent(e.get("course_url"));return(0,n.jsx)(o.ZP,{href:t,children:"Continue Your Course"})}return(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"})}renderBody(){const{passedAccuracyBar:e,passedSpeedBar:t}=this.props.submissionResponse;return e&&t?(0,n.jsxs)("div",{className:"jsx-71cfad0d76e6360f completion-message",children:[!this.props.simpleFeedbackModalClosing&&this.renderRedirect(),(0,n.jsx)(i(),{id:"71cfad0d76e6360f",children:".completion-message.jsx-71cfad0d76e6360f{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;justify-content:center;color:rgba(0,0,0,.5)}"})]}):this.renderMultiTaskResponse()}render(){return(0,n.jsxs)(c.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[(0,n.jsxs)("div",{className:"jsx-e79ce5b65509592 container",children:[(0,n.jsx)("div",{className:"jsx-e79ce5b65509592 feedback-header",children:this.renderHeader()}),(0,n.jsx)("div",{className:"jsx-e79ce5b65509592 feedback-body",children:this.renderBody()})]}),(0,n.jsx)(i(),{id:"e79ce5b65509592",children:".container.jsx-e79ce5b65509592{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.feedback-header.jsx-e79ce5b65509592{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-e79ce5b65509592{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}"})]})}}t.Z=x},583951:function(e,t,s){s.d(t,{Z:function(){return C}});var n=s(824246),r=s(679892),i=s.n(r),a=s(827378),o=s(881620),c=s(802638),d=s(298784),l=s.n(d),p=s(194892),u=s(245203),h=s(68649),m=s(808704),b=s(885748),x=s(626407),g=s.n(x);const f=[m.GraderBuckets.Missing,m.GraderBuckets.Extraneous,m.GraderBuckets.Incorrect],y=e=>e&&e.frames&&e.frames[0].text,k=(e,t)=>{const s=t&&t.props&&t.props.label;for(const n of(0,b.depthFirstLabels)(e))if(n.name===s)return n},j=e=>{var t,s;const{submissionResponse:r,trainingScenario:i}=e,o=v(),c=null===(t=null===r||void 0===r?void 0:r.graderResponse)||void 0===t?void 0:t.matchedAnnotationsList,d=null===i||void 0===i||null===(s=i.graderParams)||void 0===s?void 0:s.perAnnotationFeedback,p=a.useMemo((()=>{var e;return null!==(e=(0,m.getBucketedGradedAnnotations)(null!==c&&void 0!==c?c:[],null!==d&&void 0!==d?d:{}))&&void 0!==e?e:{}}),[c,d]);return(0,n.jsxs)("div",{className:o.graderResponse,children:[(0,n.jsx)("div",{className:o.graderResponseHeader,children:"Error Summary"}),f.map((e=>{const t=p[e];if(!(null===t||void 0===t?void 0:t.length))return null;const s=l().groupBy(t,(e=>e.metadata.props.type)),r=l().size(s.relationship);return(0,n.jsxs)("div",{className:o.bucket,children:[(0,n.jsxs)("div",{className:o.bucketHeader,children:[(0,n.jsx)("div",{className:o.bucketName,children:e}),(0,n.jsx)("div",{className:o.bucketCount,children:t.length})]}),l().map(s.annotation,(t=>(0,n.jsx)(w,{labels:i.params.labels,bucketName:e,gradedAnnotation:t},t.metadata.props.id))),r>0&&(0,n.jsxs)("div",{children:["+ errors from ",r," ",g()("relationship",r)]})]},e)}))]})};j.displayName="TrainingFeedbackSummary";const w=e=>{const{labels:t,bucketName:s,gradedAnnotation:r}=e,i=v(),a=(e,t)=>{var s;return(0,n.jsx)("span",{children:`"${e}" (${null!==(s=null===t||void 0===t?void 0:t.display_name)&&void 0!==s?s:null===t||void 0===t?void 0:t.name})`})},o=s!==m.GraderBuckets.Missing,c=s!==m.GraderBuckets.Extraneous,d=y(r.currentAnnotation)||y(r.correctAnnotation),p=y(r.correctAnnotation)||y(r.currentAnnotation),u=k(t,r.currentAnnotation),h=k(t,r.correctAnnotation);return(0,n.jsxs)("div",{className:i.bucketItem,children:[(0,n.jsxs)("div",{className:i.bucketItemName,children:[o&&a(d,u),o&&c&&(0,n.jsx)("span",{className:i.elevatedText,children:"\xa0 \u2192 \xa0"}),c&&a(p,h)]}),(0,n.jsx)("div",{className:i.bucketItemErrors,children:l().map(r.errors,(e=>(0,n.jsx)("div",{className:i.errorMessage,children:e})))})]})};w.displayName="TrainingFeedbackAnnotationRow";const v=(0,h.ZL)({graderResponse:{overflowX:"hidden",overflowY:"auto",flexShrink:0,width:360,overflow:"auto",background:"white",borderTop:"1px solid var(--color-RemoGray01)",borderLeft:"1px solid var(--color-RemoGray01)",fontSize:"15px"},graderResponseHeader:{height:52,padding:"0 16px",display:"flex",alignItems:"center",borderBottom:"1px solid var(--color-RemoGray01)",fontWeight:400},elevatedText:{display:"inline-block",marginBottom:9},bucket:{padding:16,fontSize:"14px",borderTop:"1px solid #e6e6e6"},bucketHeader:{display:"flex",flexDirection:"row",marginBottom:13},bucketName:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:400,opacity:1},bucketCount:{fontWeight:400,opacity:.5,marginLeft:"auto"},bucketItem:{margin:"16px 0"},bucketItemName:{marginBottom:8,fontWeight:400},bucketItemErrors:{marginLeft:16},errorMessage:{color:"rgba(0, 0, 0, 0.5)",paddingTop:4,paddingBottom:4}});var S=j;function T(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var C=e=>{const{passedAccuracyBar:t,passedSpeedBar:s,timeSpentSecs:r,accuracy:d,passedBar:h,submitted:m,earnedReward:b}=e.submissionResponse,{isInstructiveBenchmark:x,allowedToSeeAnswerKey:g,isConditionallyInstructiveBenchmark:f,isConditionallyInstructiveBenchmarkPassed:y,simpleFeedbackModalClosing:k}=e,{params:j}=e.trainingScenario,w=t&&s,v=`${(100*Math.max(0,d)).toFixed(2)}%`,C="#008EFF",R="#19B629",A="#F2C94C",P="#EC322F";let F,N;if(!1===j.showGrade)N=C,F=(0,n.jsx)("span",{children:"Review all of your errors to see how well you did. Ask a trainer or on Slack when you are not sure."});else if(x)1===d||f&&y?(N=R,F=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",v,"!"]})," Great work!"," "]})):h?(N=A,F=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",v,"."]})," Pretty good!",g&&"Take a look at the Answer Key to identify issues to improve on."]})):(N=P,F=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",v,"."]}),g&&"Take a look at the Answer Key to identify issues to improve on."]}));else if(w)N=R,F=(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(t){const e=Math.floor(r/60),t=Math.floor(r%60),s=`${e}:${l().padStart(t.toString(),2,"0")}`;N=A,F=(0,n.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,n.jsx)("strong",{children:s})," wasn't quite fast enough."]})}else N=P,F=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your response was ",v," accurate."]})," ",g&&"Take a look at the Answer Key to identify issues."]});const I={message:F,color:N},{backToQueue:B}=e,O=f&&y,_=(0,n.jsxs)("div",{className:"jsx-25691d5b6853096b cta-buttons",children:[k?(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Close"})}):(0,n.jsxs)(a.Fragment,{children:[x&&(0,n.jsx)(a.Fragment,{children:1===d||m||O?(0,n.jsx)("div",{onClick:B,className:"jsx-25691d5b6853096b cta-button primary",children:"Back to Queue"}):(0,n.jsx)("div",{onClick:B,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})}),!x&&!w&&(0,n.jsxs)(a.Fragment,{children:[s&&(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button secondary",children:"Clear & Restart"}),(0,n.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]}),!s&&(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button primary",children:"Retry"})})]})]}),(0,n.jsx)(i(),{id:"25691d5b6853096b",children:".cta-buttons.jsx-25691d5b6853096b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-25691d5b6853096b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-25691d5b6853096b+.cta-button.jsx-25691d5b6853096b{margin-left:16px}.cta-button.primary.jsx-25691d5b6853096b{padding:4px 12px;font-weight:400;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-25691d5b6853096b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-25691d5b6853096b{padding:4px 0px;background:none;font-weight:normal}"})]});let z;const M=new URLSearchParams(window.location.search);if(!k)if(M.has("course_url")){const e=decodeURIComponent(M.get("course_url"));z=(0,n.jsx)(o.ZP,{href:e,children:"Continue Your Course"})}else z=(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"});const{rewardAmountHundredthsOfCents:Z}=e.trainingScenario,E=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){T(e,t,s[t])}))}return e}({},e.trainingScenario,{instruction:e.trainingScenario.instructions}),L=!(Z>0);let $;return w&&!x&&($=b||L?L?(0,n.jsxs)(n.Fragment,{children:["Complete more Training Courses to become enabled on more challenging, higher-paying tasks.\xa0\xa0",z]}):(0,n.jsxs)(n.Fragment,{children:["You earned $",Z/1e4," for your great work. If you use these skills on tasks, you can do them faster and earn more!\xa0\xa0",z]}):(0,n.jsxs)(n.Fragment,{children:["You've already claimed the reward for this challenge.\xa0\xa0",z]})),(0,n.jsxs)(c.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[(0,n.jsxs)("div",{className:"jsx-d6867e5b1ab5e00 container",children:[(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00 feedback-header",children:(0,n.jsxs)("div",{style:{background:I.color},className:"jsx-d6867e5b1ab5e00 header",children:[(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:I.message}),e.isCorpUser&&(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:`Training Attempt Id: ${e.trainingAttempt}`},"trainingAttemptId"),(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:_})]})}),(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00 feedback-body",children:w&&!x?(0,n.jsx)("div",{className:"jsx-d6867e5b1ab5e00 completion-message",children:$}):(0,n.jsxs)(n.Fragment,{children:[g&&(0,n.jsx)(S,{trainingScenario:e.trainingScenario,submissionResponse:e.submissionResponse}),e.allowedToSeeAnswerKey?(0,n.jsx)(p.Z,{subtask:E,responses:e.responses,diffingResponse:e.diffingResponse,diffingResponseName:"Problem Zones",hideLabels:!0}):(0,n.jsx)(u.Z,{subtask:E,responses:[e.responses[0]]})]})})]}),(0,n.jsx)(i(),{id:"d6867e5b1ab5e00",children:".completion-message.jsx-d6867e5b1ab5e00{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;justify-content:center;color:rgba(0,0,0,.5)}.header.jsx-d6867e5b1ab5e00{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}.container.jsx-d6867e5b1ab5e00{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.feedback-header.jsx-d6867e5b1ab5e00{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-d6867e5b1ab5e00{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}"})]})}},821095:function(e,t,s){s.d(t,{Z:function(){return Z}});var n=s(824246),r=s(679892),i=s.n(r),a=s(827378),o=s(881620),c=s(802638),d=s(298784),l=s.n(d),p=s(321382),u=s(213282),h=s(692975),m=s(431350),b=s(629586),x=s(68649),g=s(857428);const f={[g.S.Video]:"Watch the following short video to understand the correct answer:",[g.S.Markdown]:"Read the following explanation to understand the correct answer:"},y=({content:e,onViewedContent:t})=>{const s=j();return(0,n.jsx)("div",{className:s.videoContainer,children:(0,n.jsx)(h.Z,{controls:!0,height:"100%",url:e.videoUrl,onEnded:t})})},k=({content:e,onViewedContent:t})=>(a.useEffect((()=>{setTimeout((()=>{t()}),3e3)}),[t]),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:u.ZP.render(e.markdownText)}})),j=(0,x.ZL)({container:{background:"white",padding:36,minHeight:"80vh"},header:{marginTop:0},contentContainer:{marginTop:16,display:"flex",height:"70vh"},videoContainer:{display:"flex",justifyContent:"center",flexGrow:1},continueButtonContainer:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:16}});var w=({instructionReminder:e,onClose:t})=>{const[s,r]=a.useState(!1),i=j();var o;const c=null!==(o=e.description)&&void 0!==o?o:f[e.content.type];return(0,n.jsxs)("div",{className:i.container,children:[(0,n.jsx)(b.H1,{children:c}),(0,n.jsxs)("div",{className:i.contentContainer,children:[e.content.type===g.S.Video&&(0,n.jsx)(y,{content:e.content,onViewedContent:()=>r(!0)}),e.content.type===g.S.Markdown&&(0,n.jsx)(k,{content:e.content,onViewedContent:()=>r(!0)})]}),(0,n.jsx)("div",{className:i.continueButtonContainer,children:(0,n.jsx)(m.zx,{onClick:t,disabled:!s,type:"primary",children:"View Feedback"})})]})},v=s(775222),S=s(604375),T=s(746332),C=s(60042),R=s.n(C),A=s(599789),P=s(554211),F=s(50682),N=s.n(F);const I=(0,s(66443).Z)("benchmarkreporting");var B=s(807556),O=s(285556);function _(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function z(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function a(e){_(i,n,r,a,o,"next",e)}function o(e){_(i,n,r,a,o,"throw",e)}a(void 0)}))}}function M(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Z=e=>{var t;const{passedAccuracyBar:s,passedSpeedBar:r,timeSpentSecs:d,accuracy:u,passedBar:h,submitted:m,earnedReward:b,graderResponse:x,instructionReminder:g}=e.submissionResponse,f=(0,P.ZP)("show-bm-rewards",{projectId:e.project},!1),[y,k]=a.useState(!1),j=(0,P.ZP)("disable-bm-reporting",{projectId:e.trainingScenario.project},!1),C=a.useCallback(z((function*(){if(j)return void k(!1);if(e.isCorpUser)return void k(!0);const{success:t,allowReporting:s}=yield(0,O.ZP)(null,`corp-api/qm/benchmark/allow-reporting/${e.trainingScenario.project}/${e.loggedUserId}`,{method:"GET"});t&&s&&k(!0)})),[j,e.loggedUserId,e.trainingScenario.project,e.isCorpUser]);a.useEffect((()=>{C()}),[C]);const{isInstructiveBenchmark:F,allowedToSeeAnswerKey:_,isConditionallyInstructiveBenchmark:Z,isConditionallyInstructiveBenchmarkPassed:E,simpleFeedbackModalClosing:L}=e,{params:$,trainingType:D,rewardAmountHundredthsOfCents:U}=e.trainingScenario,G=D===A.TrainingScenarioType.AccuracyBenchmark,Y=s&&r,H=`${(100*Math.max(0,u)).toFixed(2)}%`,V="#008EFF",K="#19B629",W="#F2C94C",q="#EC322F";let Q,X;if(!1===$.showGrade||G)X=V,Q=(0,n.jsx)("span",{children:"Your submission will be reviewed."});else if(F)h||Z&&E?(X=K,Q=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",H,"!"]})," Great work!"," ",f&&`This task earned you $${U/1e4}.`]})):(X=q,Q=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your accuracy on this task was ",H,"."]}),_&&"Take a look at the Answer Key to identify issues to improve on."]}));else if(Y)X=K,Q=(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(s){const e=Math.floor(d/60),t=Math.floor(d%60),s=`${e}:${l().padStart(t.toString(),2,"0")}`;X=W,Q=(0,n.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,n.jsx)("strong",{children:s})," wasn't quite fast enough."]})}else X=q,Q=(0,n.jsxs)("span",{children:[(0,n.jsxs)("strong",{children:["Your response was ",H," accurate."]})," ",_&&"Take a look at the Answer Key to identify issues."]});const J={message:Q,color:X},{backToQueue:ee}=e,te=Z&&E,[se,ne]=a.useState(!0),re=function(){var t=z((function*(t,s){ne(!1);const n={reports:[{worker:e.loggedUserId,trainingAttempt:e.trainingAttempt||e.submissionResponse._id||"",reason:t,explanation:s,reportedAt:new Date}]};yield(0,O.ZP)(null,`corp-api/qm/benchmark/${e.trainingScenario.id}`,{method:"PUT",body:n}),e.trainingScenario&&((e,t,s,n)=>{I.incr("reportTask",1,{projectId:e||"undefined_project_id",taskId:t||"undefined_task_id",userId:s||"undefined_user_id",explanation:n||"undefined_explanation"})})(e.trainingScenario.project,e.trainingScenario.id,e.loggedUserId,s)}));return function(e,s){return t.apply(this,arguments)}}(),ie=se&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{"data-tip":"Report if you disagree with the answer key. You must still Fix Answer and resubmit to pass.",children:(0,n.jsx)(B.Z,{disabled:!1,handleReport:re,style:{marginRight:12,backgroundColor:"var(--color-RemoGold)",color:"white"},buttonText:"Report",reportBodyText:"Please let us know what's wrong with this task so we can make tasking better for you.",reportHeaderText:"Report this task",explanationPlaceholder:"I disagree with the answer key because...",closeModalOnReport:!0,isBenchmarkReporting:!0})}),(0,n.jsx)(N(),{place:"left"})]}),ae=(0,n.jsxs)("div",{className:"jsx-25691d5b6853096b cta-buttons",children:[L?(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Close"})}):(0,n.jsxs)(a.Fragment,{children:[F&&(0,n.jsx)(a.Fragment,{children:h||m||te?(0,n.jsx)("div",{onClick:ee,className:"jsx-25691d5b6853096b cta-button primary",children:"Back to Queue"}):(0,n.jsxs)(a.Fragment,{children:[y&&ie,(0,n.jsx)("div",{onClick:ee,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]})}),!F&&!Y&&!G&&(0,n.jsxs)(a.Fragment,{children:[r&&(0,n.jsxs)(a.Fragment,{children:[y&&ie,(0,n.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button secondary",children:"Clear & Restart"}),(0,n.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]}),!r&&(0,n.jsx)(a.Fragment,{children:(0,n.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button primary",children:"Retry"})})]})]}),(0,n.jsx)(i(),{id:"25691d5b6853096b",children:".cta-buttons.jsx-25691d5b6853096b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-25691d5b6853096b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-25691d5b6853096b+.cta-button.jsx-25691d5b6853096b{margin-left:16px}.cta-button.primary.jsx-25691d5b6853096b{padding:4px 12px;font-weight:400;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-25691d5b6853096b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-25691d5b6853096b{padding:4px 0px;background:none;font-weight:normal}"})]});let oe;const ce=new URLSearchParams(window.location.search);L||(oe=ce.has("course_url")?(0,n.jsx)("a",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},onClick:()=>window.close(),children:"Continue Your Course (Closes this tab)"}):(0,n.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"}));const de=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){M(e,t,s[t])}))}return e}({},e.trainingScenario,{instruction:e.trainingScenario.instructions}),le=!(U>0);let pe;Y&&!F&&(pe=b||le?le?(0,n.jsxs)(n.Fragment,{children:["Complete more Training Courses to become enabled on more challenging, higher-paying tasks.\xa0\xa0",oe]}):(0,n.jsxs)(n.Fragment,{children:["You earned $",U/1e4," for your great work. If you use these skills on tasks, you can do them faster and earn more!\xa0\xa0",oe]}):(0,n.jsxs)(n.Fragment,{children:["You've already claimed the reward for this challenge.\xa0\xa0",oe]}));const ue=x.graderDiffResponse,[he,me]=a.useState(!!g);a.useEffect((()=>{g&&(he?v.c.track("Instruction Reminder Shown",{instructionReminderId:g._id,trainingAttempt:e.trainingAttempt}):v.c.track("Instruction Reminder Completed",{instructionReminderId:g._id,trainingAttempt:e.trainingAttempt}))}),[g,e.trainingAttempt,he]);const be=(0,S.ZL)({header:{height:"56px",padding:"0 16px",display:"flex",justifyContent:"space-between",alignItems:"center",color:"white",fontSize:"15px",[`@media (max-width: ${T.MOBILE_THRESHOLD})`]:{height:"auto",padding:"16px",flexDirection:"column"}},headerSectionResponsive:{[`@media (max-width: ${T.MOBILE_THRESHOLD})`]:{marginBottom:"8px"}}})();return(0,n.jsxs)(c.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[!!g&&he&&(0,n.jsx)(w,{instructionReminder:g,onClose:()=>me(!1)}),!he&&(0,n.jsxs)("div",{className:"jsx-795bdccce560f4b6 container",children:[(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6 feedback-header",children:(0,n.jsxs)("div",{style:{background:J.color},className:"jsx-795bdccce560f4b6 "+(R()(be.header)||""),children:[(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6 "+(R()(be.headerSectionResponsive)||""),children:J.message}),e.isCorpUser&&(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6 "+(R()(be.headerSectionResponsive)||""),children:`Training Attempt Id: ${e.trainingAttempt}`},"trainingAttemptId"),(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6",children:ae})]})}),(0,n.jsxs)("div",{className:"jsx-795bdccce560f4b6 feedback-body",children:[(l().isNil($.showGrade)||$.showGrade)&&(0,n.jsx)(n.Fragment,{children:Y&&!F?(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6 completion-message",children:pe}):(0,n.jsx)(p.Z,{params:de.params,graderDiffResponse:ue,feedbackComment:(null===(t=e.trainingScenario.params)||void 0===t?void 0:t.feedbackComment)||e.trainingScenario.feedbackMessage,loggedUserId:e.loggedUserId,useProtectedText:e.useProtectedText,project:e.project,passedChallenge:Y})}),!1===$.showGrade&&(0,n.jsx)("div",{className:"jsx-795bdccce560f4b6 completion-message",children:"Your submission will be reviewed."})]})]}),(0,n.jsx)(i(),{id:"795bdccce560f4b6",children:".completion-message.jsx-795bdccce560f4b6{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;justify-content:center;color:rgba(0,0,0,.5)}.container.jsx-795bdccce560f4b6{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.grader-response.jsx-795bdccce560f4b6{overflow-x:hidden!important;overflow-y:auto;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:360px;overflow:auto;background:white;border-top:1px solid var(--color-RemoGray01);border-left:1px solid var(--color-RemoGray01);font-size:15px}.grader-response-header.jsx-795bdccce560f4b6{height:52px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid var(--color-RemoGray01);font-weight:400}.feedback-header.jsx-795bdccce560f4b6{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-795bdccce560f4b6{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden;width:100%}"})]})}},308609:function(e,t,s){function n(e,...t){t.forEach((t=>{e[t]=e[t].bind(e)}))}s.d(t,{Z:function(){return n}})},484815:function(e,t,s){s.d(t,{em:function(){return o},mW:function(){return d},$L:function(){return p},ty:function(){return h},cx:function(){return b},nN:function(){return g},BF:function(){return y},L2:function(){return j}});var n=s(285556),r=s(581698);function i(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function a(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var a=e.apply(t,s);function o(e){i(a,n,r,o,c,"next",e)}function c(e){i(a,n,r,o,c,"throw",e)}o(void 0)}))}}function o(e){return c.apply(this,arguments)}function c(){return(c=a((function*({context:e}){const t=yield(0,n.ZP)(e,"internal/canAccessLidar",{returnRawResponse:!0});return t&&t.ok}))).apply(this,arguments)}function d(){return l.apply(this,arguments)}function l(){return(l=a((function*(e={},{context:t,cache:s=!1}={}){const n=v(s);return(yield n(t,"internal/projects",{query:e})).docs}))).apply(this,arguments)}function p(){return u.apply(this,arguments)}function u(){return(u=a((function*(e={},{context:t}={}){const s=v(!1);return yield s(t,"internal/projects",{method:"POST",body:e})}))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=a((function*(e,t={},{context:s}={}){const n=`internal/projects/${e}`,r=v(!1);return yield r(s,n,{method:"PUT",body:t})}))).apply(this,arguments)}function b(e){return x.apply(this,arguments)}function x(){return(x=a((function*(e,{context:t}={}){const s=`internal/projects/${e}/pin`,n=v(!1);return yield n(t,s,{method:"PUT"})}))).apply(this,arguments)}function g(e){return f.apply(this,arguments)}function f(){return(f=a((function*(e,{context:t}={}){const s=`internal/projects/${e}/unpin`,n=v(!1);return yield n(t,s,{method:"PUT"})}))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=a((function*(e,{context:t}={}){const s=`internal/projects/${e}/archive`,n=v(!1);return yield n(t,s,{method:"PUT"})}))).apply(this,arguments)}function j(e){return w.apply(this,arguments)}function w(){return(w=a((function*(e,{context:t}={}){const s=`internal/projects/${e}/unarchive`,n=v(!1);return yield n(t,s,{method:"PUT"})}))).apply(this,arguments)}function v(e){return e?r.Z:n.ZP}},107555:function(e,t,s){s.d(t,{Z:function(){return ve}});var n=s(824246),r=s(679892),i=s.n(r),a=s(60042),o=s.n(a),c=s(298784),d=s.n(c),l=s(827378),p=s(792739),u=s(959807),h=s.n(u),m=s(468891),b=s(604375),x=s(885564),g=s(687192),f=s(942662),y=s(4369),k=s(802638),j=s(876116),w=s(128819),v=s(392886);const S=3600,T=e=>{const t=parseInt(e,10),s=Math.floor(t/S),n=Math.floor((t-s*S)/60);return`${s?s+":":""}${n}:${(e=>e<10?`0${e}`:e)(t-s*S-60*n)}`};var C=s(98283),R=s(285556),A=s(308609),P=s(891765),F=s(75384),N=s(700190),I=s(279220),B=s(599789),O=s(167469),_=s(537425);function z(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function M(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function a(e){z(i,n,r,a,o,"next",e)}function o(e){z(i,n,r,a,o,"throw",e)}a(void 0)}))}}function Z(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function E(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){Z(e,t,s[t])}))}return e}var L=e=>{const{0:t,1:s}=(0,l.useState)(),{0:n,1:r}=(0,l.useState)(),{0:i,1:a}=(0,l.useState)();(0,I.Z)(M((function*(){if(!e||!e.assignmentId)return;const{assignmentId:t}=e,n=`internal/guided_workflow/scenario/${t}`,r=yield(0,R.ZP)(null,n);r&&r.enabled&&s(r.workflow)})),[e]),(0,I.Z)(M((function*(){if(!(null===e||void 0===e?void 0:e.projectId))return;const t=`internal/ontology/${e.projectId}`,s=yield(0,R.ZP)(null,t);s&&(r(s.ontologyHistory),a(s.ontologyInstructions))})),[e]);const o=!!t,c=E({},(0,_.T)(e),null===e||void 0===e?void 0:e.featureFlags,{canUseGuidedWorkflowBar:o}),p=(0,l.useContext)(F.ZP),u=!d().includes(B.twoDTypes,null===e||void 0===e?void 0:e.type)&&(null===e||void 0===e?void 0:e.type)!==O.TaskType.DocumentTranscription&&(null===e||void 0===e?void 0:e.type)!==O.TaskType.TextCollection&&(null===e||void 0===e?void 0:e.type)!==O.TaskType.Chat,h=(0,N.h)(`internal/config/${null===e||void 0===e?void 0:e.projectId}`,{shouldShortCircuit:u});if(!e)return;const m={loggedUserId:null===p||void 0===p?void 0:p._id,taskerWorkflowDefinition:t,ontologyHistory:n,ontologyInstructions:i,config:h.response,projectConfig:h.response};return E({},e,m,{featureFlags:c})};var $=e=>{const{assignment:t,newRenderFunction:s}=e;return s(L(t))},D=s(68649),U=s(518496);const G=(0,D.ZL)({root:{pointerEvents:"none"},paper:{background:"none",boxShadow:"none"}});var Y=({element:e})=>{const t=e.getBoundingClientRect(),s=t.height+14,r=t.width+14,a=G();return(0,n.jsxs)(U.ZP,{elevation:9,open:!0,anchorEl:e,anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"left"},classes:{root:a.root,paper:a.paper},children:[(0,n.jsxs)("div",{className:i().dynamic([["dc7826e970a7c84f",[r,s]]])+" tutorial-highlight",children:[(0,n.jsx)("div",{className:i().dynamic([["dc7826e970a7c84f",[r,s]]])+" tutorial-highlight-rect-container",children:(0,n.jsx)("svg",{className:i().dynamic([["dc7826e970a7c84f",[r,s]]]),children:(0,n.jsx)("rect",{id:"box",x:"0",y:"0",width:r,height:s,className:i().dynamic([["dc7826e970a7c84f",[r,s]]])+" tutorial-highlight-rect"})})}),(0,n.jsx)("div",{className:i().dynamic([["dc7826e970a7c84f",[r,s]]])+" tutorial-highlight-arrow-container",children:(0,n.jsx)(p.G,{icon:"arrow-left",style:{marginLeft:"10px",fontSize:"50px",color:y.w.ScaleBlue}})})]}),(0,n.jsx)(i(),{id:"dc7826e970a7c84f",dynamic:[r,s],children:`.tutorial-highlight.__jsx-style-dynamic-selector{z-index:99!important;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;pointer-events:none;background:none}.tutorial-highlight-rect-container.__jsx-style-dynamic-selector{width:${r}px;height:${s}px;-webkit-animation-name:pulse;-moz-animation-name:pulse;-o-animation-name:pulse;animation-name:pulse;-webkit-animation-duration:3s;-moz-animation-duration:3s;-o-animation-duration:3s;animation-duration:3s;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;-o-animation-iteration-count:infinite;animation-iteration-count:infinite}.tutorial-highlight-rect.__jsx-style-dynamic-selector{fill:none;stroke:#0076ff;stroke-width:8;stroke-opacity:.9}@keyframes pulse{from{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(.85);-moz-transform:scale(.85);-o-transform:scale(.85);transform:scale(.85)}to{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}`})]})},H=s(287731),V=s(255774),K=s(561441),W=s(583951),q=s(821095),Q=s(13848),X=s(271682),J=s(160337),ee=s(626199),te=s(161320),se=s.n(te),ne=s(881620),re=s(775222),ie=s(135277),ae=s(556583),oe=s(950743),ce=s(237896),de=s(153987),le=s(484815),pe=s(430775);function ue(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function he(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function a(e){ue(i,n,r,a,o,"next",e)}function o(e){ue(i,n,r,a,o,"throw",e)}a(void 0)}))}}function me(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function be(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){me(e,t,s[t])}))}return e}const xe=function(){var e=he((function*(e){const t=yield de.Z.getInitialProps(e),s=(e.user.trainerProject||e.user.isCorporateUser)&&e.query.show_answer,n=e.user.isCorporateUser;n||"disabled"!==e.authCache.trainingScenario.benchmark.status||pe.Z.error(`trainingScenario benchmark status is disabled for tasker ${e.user._id}, and training scenario is ${e.authCache.trainingScenario._id} and project ${e.authCache.trainingScenario.project}`);const r=yield(0,R.ZP)(e,`internal/config/${e.authCache.trainingScenario.project}`);return be({},t,e.authCache,{query:e.query,overrideAnswerKeyCooldown:s,isCorpUser:n,projectConfig:r})}));return function(t){return e.apply(this,arguments)}}();var ge=s(278668),fe=s(553999);function ye(e,t,s,n,r,i,a){try{var o=e[i](a),c=o.value}catch(d){return void s(d)}o.done?t(c):Promise.resolve(c).then(n,r)}function ke(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function a(e){ye(i,n,r,a,o,"next",e)}function o(e){ye(i,n,r,a,o,"throw",e)}a(void 0)}))}}function je(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function we(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){je(e,t,s[t])}))}return e}class ve extends l.Component{get defaultState(){return{showingInstructions:!0,showingSummary:!1,showingLeaderboard:!0,responseIndex:0,currentTutorialStep:0,isTutorial:!1,isVerificationAttempt:!1}}get taskComponent(){return this.task.current}waitForLoad(){var e=this;return ke((function*(){for(;!e.taskComponent||!e.taskComponent.labeler;)yield h().delay(500)}))()}UNSAFE_componentWillMount(){this.setState(this.defaultState)}componentDidMount(){var e=this;return ke((function*(){var t;window.addEventListener("keydown",(t=>{e.onTutorialInteraction({type:ie.TutorialStep.Shortcut,shortcutTrigger:[t.key]})})),setInterval(e.updateHighlightedElement,2e3);const s=new URLSearchParams(window.location.search),n=Boolean(s.get("isVerificationAttempt"));e.setState({isVerificationAttempt:null!==n&&void 0!==n&&n}),(null===(t=e.props.trainingScenario)||void 0===t?void 0:t.benchmark.type)===B.BenchmarkType.Tutorial&&e.setState({isTutorial:!0}),e.props.submissionResponse&&(yield e.waitForLoad(),e.setState({submissionResponse:e.props.submissionResponse,showingSummary:!0,showingInstructions:!1})),re.c.track("Training - Opens BM"),e.logMetrics()}))()}logMetrics(){try{var e,t;if(this.props.throttleTimeMs)re.c.track("Throttled training page",{scenarioId:null===(e=this.props.trainingScenario)||void 0===e?void 0:e._id,projectId:null===(t=this.props.trainingScenario)||void 0===t?void 0:t.project})}catch(s){}}canViewAnswerKey(){return this.props.overrideAnswerKeyCooldown||this.state.submissionResponse&&this.state.submissionResponse.timeSpentSecs>=this.props.trainingScenario.minimumAttemptTimeSeconds}startTraining(){if(this.taskComponent){this.taskComponent.taskTimer.reset(0)}this.setState({showingInstructions:!1})}getSubmitDisabledStatus(){var e;const t=d().size(null===(e=this.props.trainingScenario)||void 0===e?void 0:e.tutorialSteps),{currentTutorialStep:s}=this.state;return t&&s<t?{canSubmit:!1,submitTooltip:"Follow all the steps to finish this training scenario."}:{canSubmit:!0,submitTooltip:null}}onSubmit(e,t){var s=this;return ke((function*(){const e=d().get(s.props.trainingScenario,"graderParams.version",1);if(s.props.query.edit_scenario||s.props.query.edit_answer_key)return yield s.submitScenarioEdit(!!s.props.query.edit_answer_key),void s.setState({scenarioUpdated:!0});const{ready:n,submissionResponse:r}=yield(0,R.ZP)(null,`internal/training/complete/${s.props.trainingScenario.taskType}/${s.props.trainingAttempt}?${m.stringify({grader_version:e})}`,{method:"POST",body:t}),i=e=>{e.passedSpeedBar&&e.passedAccuracyBar?re.c.track("Training - Passed Linter"):re.c.track("Training - Prompt/Response/Task linter triggered"),s.setState({lastSubmittedProblemZones:e.problemZonesResponse,submissionResponse:e,showingGrade:!0}),s.showSummary()};if(s.state.isTutorial&&n){const e=we({},r,{passedBar:!0,passedAccuracyBar:!0,passedSpeedBar:!0});return void i(e)}if(n)return void i(r);const a=setInterval(ke((function*(){const{submissionResponse:e,ready:t}=yield(0,R.ZP)(null,`internal/training/fetch/${s.props.trainingAttempt}`);t&&(clearInterval(a),s.state.isTutorial&&i(we({},e,{passedBar:!0,passedAccuracyBar:!0,passedSpeedBar:!0})),i(e))})),5e3)}))()}onTutorialInteraction(e){var t,s,n;const{currentTutorialStep:r}=this.state;((e,t)=>{if(e.type!==(null===t||void 0===t?void 0:t.type))return!1;if(e.type===ie.TutorialStep.SelectAnnotation){const s=t,{startFrame:n,endFrame:r}=s;return!(n&&e.startFrame<n||r&&e.endFrame>r)&&e.annotationId===s.annotationId}if(e.type===ie.TutorialStep.LidarFeature){const i=t;if(e.featureName!==i.featureName)return!1;if(d().isEmpty(i.featureOpts))return!0;var s;const a=null!==(s=i.featureOpts)&&void 0!==s?s:{},o=a.threshold,c=a.value;var n;const l=null!==(n=e.featureOpts)&&void 0!==n?n:{},p=l.value;return(!a.subFeature||a.subFeature===l.subFeature)&&(d().isFinite(o)&&d().isFinite(c)?!!d().isFinite(p)&&Math.abs(c-p)<=o:!!d().isNil(c)||c===(null===(r=e.featureOpts)||void 0===r?void 0:r.value));var r}return d().isEqual(e,t)})(e,null===(t=this.props.trainingScenario)||void 0===t||null===(s=t.tutorialSteps)||void 0===s||null===(n=s[r])||void 0===n?void 0:n.interaction)&&this.setState({currentTutorialStep:r+1})}retryTraining(e=!1){var t;if(re.c.track("Training - Redo BM"),(null===(t=this.props.trainingScenario)||void 0===t?void 0:t.taskType)===O.TaskType.LidarAnnotation){const t=new URL(window.location.href);!0===e?t.searchParams.set("retry","1"):t.searchParams.delete("retry"),window.location.href=t.href}else{var s;(null===(s=this.taskComponent)||void 0===s?void 0:s.discardChanges)&&this.taskComponent.discardChanges(),window.location.reload()}}makeChanges(){if(this.taskComponent){const e=this.taskComponent.taskTimer,t=1e3*this.state.submissionResponse.timeSpentSecs;e.reset(t),this.taskComponent.resetSubmit()}this.hideSummary()}exit(){(0,C.ZP)(null,"/dashboard")}get includeInitialResponse(){var e,t;const{user:s,query:n}=this.props;return s.isCorporateUser&&(null===n||void 0===n?void 0:n.view_initial_response)&&(null===(e=this.props.trainingScenario)||void 0===e||null===(t=e.params)||void 0===t?void 0:t.initialScene)}get responsesReady(){return!!this.state.submissionResponse}get initialTrainingScenarioSubtask(){var e,t,s;return(null===(e=this.props.query)||void 0===e?void 0:e.view_initial_response)?null===(t=this.props.trainingScenario)||void 0===t||null===(s=t.params)||void 0===s?void 0:s.initialScene:void 0}get scenesToLoad(){return[this.props.trainingAttempt,this.initialTrainingScenarioSubtask].filter((e=>!!e))}render2DScenarioHeader(){const e=this.props.user.accountType===B.AccountType.Expert;return(0,n.jsxs)("div",{className:"jsx-695fe4a0b9e08858 training-header",children:[(0,n.jsxs)("div",{className:"jsx-695fe4a0b9e08858 training-header__meta",children:[(0,n.jsx)("span",{className:"jsx-695fe4a0b9e08858 training-header__title",children:(0,n.jsx)("strong",{className:"jsx-695fe4a0b9e08858",children:this.props.trainingScenario.name})}),(0,n.jsx)("span",{className:"jsx-695fe4a0b9e08858 training-header__subtitle",children:(0,n.jsx)("strong",{className:"jsx-695fe4a0b9e08858",children:this.props.trainingScenario.description})})]}),(0,n.jsx)("div",{className:"jsx-695fe4a0b9e08858 training-header__subtitle",children:!0!==this.props.hideBackButton&&(0,n.jsxs)(f.Z,{type:"link",onClick:this.props.toggleShowingFeedback,style:{color:"rgba(0,0,0,0.4)",marginLeft:"8px",marginTop:"8px"},href:e?"/expert":"/dashboard",children:[(0,n.jsx)(p.G,{icon:"chevron-left"}),"\xa0 Back To Dashboard"]})}),(0,n.jsx)(i(),{id:"695fe4a0b9e08858",children:"@media screen and (max-width:768px){.training-header.jsx-695fe4a0b9e08858{z-index:1;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid rgba(0,0,0,.1);-webkit-box-shadow:0px 0px 8px rgba(0,0,0,.05);-moz-box-shadow:0px 0px 8px rgba(0,0,0,.05);box-shadow:0px 0px 8px rgba(0,0,0,.05);background:white;color:black;font-size:15px}.training-header__meta.jsx-695fe4a0b9e08858 span.jsx-695fe4a0b9e08858{padding-right:16px}.training-header__title.jsx-695fe4a0b9e08858{font-size:20px}.training-header__subtitle.jsx-695fe4a0b9e08858{color:rgba(0,0,0,.4)}}"})]})}renderLeaderboard(){if(this.props.leaderboard)return(0,n.jsxs)("div",{className:"jsx-4324743f279bcd63 "+(o()("leaderboard",{hidden:!this.state.showingLeaderboard})||""),children:[(0,n.jsxs)("div",{className:"jsx-4324743f279bcd63 leaderboard-header",children:["\ud83c\udfc6 ",this.props.trainingScenario.name," Leaderboard"]}),(0,n.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-list",children:this.props.leaderboard.length?this.props.leaderboard.map(((e,t)=>(0,n.jsxs)("div",{className:"jsx-4324743f279bcd63 leaderboard-item",children:[(0,n.jsxs)("div",{className:"jsx-4324743f279bcd63",children:[(0,n.jsx)("span",{className:"jsx-4324743f279bcd63 ranking",children:t+1})," ",e.worker]}),(0,n.jsx)("span",{className:"jsx-4324743f279bcd63",children:"speed"===this.props.trainingScenario.trainingType?T(e.score):`${Math.floor(100*e.score)}%`})]},t))):(0,n.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-item",children:"No training scores yet"})}),(0,n.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-close",children:(0,n.jsx)("a",{onClick:this.hideLeaderboard,className:"jsx-4324743f279bcd63 btn-flat",children:"Hide"})}),(0,n.jsx)(i(),{id:"4324743f279bcd63",children:".leaderboard.jsx-4324743f279bcd63{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);padding:12px 16px;background:rgba(255,255,255,.9);color:black;font-weight:bold;font-size:13px;-webkit-transition:top.5s ease-in-out;-moz-transition:top.5s ease-in-out;-o-transition:top.5s ease-in-out;transition:top.5s ease-in-out;position:absolute;top:0;pointer-events:auto}.leaderboard.hidden.jsx-4324743f279bcd63{top:-360px}.leaderboard-list.jsx-4324743f279bcd63{margin-top:16px}.leaderboard-item.jsx-4324743f279bcd63 .ranking.jsx-4324743f279bcd63{display:inline-block;width:16px}.leaderboard-item.jsx-4324743f279bcd63{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.leaderboard-close.jsx-4324743f279bcd63{margin-top:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63{background:rgba(0,0,0,0);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;overflow:hidden;padding:.5em;-webkit-transition:background.3s ease-in-out;-moz-transition:background.3s ease-in-out;-o-transition:background.3s ease-in-out;transition:background.3s ease-in-out}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63:hover{background:rgba(0,0,0,.08)}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63:not(:first-of-type){margin-left:.5em}"})]})}renderScenarioUpdated(){if(this.state.scenarioUpdated)return(0,n.jsxs)(k.u_,{isOpen:!0,children:[(0,n.jsx)("div",{className:"jsx-504828f3394fd24e section",children:'"Scenario updated!"'}),(0,n.jsx)(i(),{id:"504828f3394fd24e",children:".section.jsx-504828f3394fd24e{padding:32px}.section.jsx-504828f3394fd24e+.section.jsx-504828f3394fd24e{border-top:1px solid var(--bg-gray-light)}"})]})}renderTutorialHighlight(){if(this.state.highlightedElement)return(0,n.jsx)(Y,{element:this.state.highlightedElement})}renderTutorialProgress(){var e,t,s;const r=d().size(null===(e=this.props.trainingScenario)||void 0===e?void 0:e.tutorialSteps);if(!r||this.state.showingInstructions)return;const{currentTutorialStep:a}=this.state,o=null===(t=this.props.trainingScenario)||void 0===t||null===(s=t.tutorialSteps)||void 0===s?void 0:s[a];var c;const l=null!==(c=null===o||void 0===o?void 0:o.instructions)&&void 0!==c?c:"All done! Once you have fixed these errors, submit your scenario.",p=(null===o||void 0===o?void 0:o.allowContinue)||(null===o||void 0===o?void 0:o.type)===ie.TutorialStep.Text?(0,n.jsx)("p",{style:{textDecoration:"underline",color:"white",cursor:"pointer"},onClick:()=>this.setState({currentTutorialStep:this.state.currentTutorialStep+1}),children:"Click here to continue"}):null;return(0,n.jsxs)("div",{className:"jsx-e3cb8d9f95dad905 tutorial-progress-container",children:[(0,n.jsxs)("div",{className:"jsx-e3cb8d9f95dad905 tutorial-progress-text",children:[(0,n.jsxs)("h3",{className:"jsx-e3cb8d9f95dad905",children:["(",a+1,"/",r+1,") ",l]}),p]}),(0,n.jsx)("div",{className:"jsx-e3cb8d9f95dad905 progress-bar-container",children:(0,n.jsx)("div",{className:"jsx-e3cb8d9f95dad905 progress-bar",children:(0,n.jsx)(P.ZP,{completed:a,total:r,height:25,fillColor:"#2ecc71",backgroundColor:"#c4e5d2"})})}),(0,n.jsx)(i(),{id:"e3cb8d9f95dad905",children:".tutorial-progress-container.jsx-e3cb8d9f95dad905{pointer-events:none;position:fixed;top:100px;left:50%;-webkit-transform:translateX(-50%);-moz-transform:translateX(-50%);-ms-transform:translateX(-50%);-o-transform:translateX(-50%);transform:translateX(-50%);z-index:99!important}.tutorial-progress-text.jsx-e3cb8d9f95dad905{pointer-events:auto;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:300px;text-align:center;background-color:rgba(0,0,0,.5);-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px}h3.jsx-e3cb8d9f95dad905{color:white;margin:8px}.progress-bar-container.jsx-e3cb8d9f95dad905{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-align:center;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:20px}.progress-bar.jsx-e3cb8d9f95dad905{width:250px;display:inline-block;margin-left:auto;margin-right:auto}"})]})}renderTaskPage(){const{query:e,trainingScenario:t,projectConfig:s}=this.props;if(!t||!t.params)return;let r;var i;r=d().get(this.state,"submissionResponse.processedResponse")?d().get(this.state,"submissionResponse.processedResponse"):d().get(e,"edit_answer_key")||t.benchmark.type===B.BenchmarkType.Tutorial&&t.benchmark.tutorialMode===fe.Xn.Instructor?t.expectedResponse:t.initialResponse;const a={trainingScenario:t,isTestQuestion:!0,config:this.props.config,projectConfig:s,showHeader:!1,showFooter:!0,isTrainingFeedbackOpen:this.state.showingSummary,onSubmit:this.onSubmit,getSubmitDisabledStatus:this.getSubmitDisabledStatus,onRetryTraining:this.retryTraining,closeTrainingFeedback:this.hideSummary,trainingResponse:this.state.submissionResponse,fixResponse:r,instruction:t.instructions,instructionObjectId:t.instructionObjectId,userFlags:this.props.user.featureFlags,loggedUserId:this.props.user.id,useProtectedText:t.useProtectedText,isSimultaneousEditing:!!e.edit_diff,ocrTextUrls:this.getOCRTextUrls(null!==(i=t.attachmentS3Downloads)&&void 0!==i?i:[])};(0,ee.Hz)(t);const o=this.transformToAssignment(t,r);var c;o&&t&&t.expectedResponse&&t.tutorialResponse&&t.benchmark.type===B.BenchmarkType.Tutorial&&(o.expectedResponse=t.expectedResponse,o.tutorialResponse=t.tutorialResponse,o.tutorialMode||(o.tutorialMode=null!==(c=t.tutorialMode)&&void 0!==c?c:t.benchmark.tutorialMode));const l=e.overrideReviewLevel||e.reviewLevel;if(o&&l){const e=parseInt(l);isNaN(e)||(o.overrideReviewLevel=e)}return(0,n.jsx)($,{assignment:o,newRenderFunction:e=>{switch(e.type){case O.TaskType.AudioTranscription:return(0,n.jsx)(j.Gi,we({ref:this.task},a,t));case O.TaskType.Categorization:return t.params.taxonomies?(0,n.jsx)(j.kq,we({ref:this.task},a,t,{examAttemptId:t.params.attachment_type===B.AttachmentType.JSON&&this.props.trainingAttempt}),t._id):(0,n.jsx)(j.LO,we({ref:this.task},a,t));case O.TaskType.Comparison:return(0,n.jsx)(j.FS,we({ref:this.task},a,t));case O.TaskType.DataCollection:return(0,n.jsx)(j.kv,we({ref:this.task},a,t));case O.TaskType.ImageAnnotation:case O.TaskType.PointAnnotation:case O.TaskType.LineAnnotation:case O.TaskType.Annotation:case O.TaskType.CuboidAnnotation:case O.TaskType.PolygonAnnotation:return(0,n.jsx)(X.M5,{children:(0,n.jsx)(j.B,we({ref:this.task},a,t,{assignment:e}))});case O.TaskType.SegmentAnnotation:return(0,n.jsx)(j.lb,we({ref:this.task},a,t,{assignment:e}));case O.TaskType.Transcription:return(0,n.jsx)(j._N,we({ref:this.task},a,t));case O.TaskType.VideoAnnotation:case O.TaskType.VideoBoxAnnotation:case O.TaskType.VideoCuboidAnnotation:case O.TaskType.VideoPolygonAnnotation:return(0,n.jsx)(X.M5,{children:(0,n.jsx)(j.xe,we({ref:this.task},a,t,{assignment:e}),t._id)});case O.TaskType.VideoPlaybackAnnotation:return(0,n.jsx)(j.sE,we({ref:this.task},a,t,{assignment:e}));case O.TaskType.LidarAnnotation:case O.TaskType.LidarSegmentation:case O.TaskType.SensorFusion:return(0,n.jsx)(Se,{trainingAttemptId:this.props.trainingAttempt});case O.TaskType.NamedEntityRecognition:return(0,n.jsx)(j.bs,we({ref:this.task},a,t),t._id);case O.TaskType.TextCollection:return t.params.externalAmsLink?(0,n.jsx)(j.fT,we({ref:this.task},a,t,{assignment:e}),t._id):(0,n.jsx)(j.JO,we({ref:this.task},a,t,{assignment:e,tasker:this.props.user}),t._id);case O.TaskType.DocumentTranscription:return(0,n.jsx)(j.QH,we({ref:this.task},a,t,{assignment:e}));case O.TaskType.Chat:return(0,n.jsx)(j.JL,we({ref:this.task},a,t,{assignment:e}))}return null}})}renderChatFeedback(){if(!this.state.showingSummary)return null;var e,t;if(this.state.showingSummary&&this.state.isTutorial&&!this.state.isVerificationAttempt)return void(this.props.onFeedbackCloseLoading||null===(t=(e=this.props).onFeedbackClose)||void 0===t||t.call(e));const s=[{name:J.DiffView.TaskerResponse,response:d().get(this.state,"submissionResponse.processedResponse"),graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams}];return(0,n.jsx)(K.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:s,isCorpUser:this.props.isCorpUser,diffingResponse:this.state.lastSubmittedProblemZones,config:this.props.config,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}render2DFeedback(){var e;if(!this.state.showingSummary)return null;const t=this.canViewAnswerKey(),s=[{name:J.DiffView.TaskerResponse,response:d().get(this.state,"submissionResponse.processedResponse"),graderResponse:t?this.state.submissionResponse.graderResponse:null,graderParams:t?this.props.trainingScenario.graderParams:null},{name:J.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}],r=null===(e=this.state.submissionResponse)||void 0===e?void 0:e.visualDiff;return r&&s.unshift({name:J.DiffView.VisualDiff,response:r,graderResponse:t?this.state.submissionResponse.graderResponse:null,graderParams:t?this.props.trainingScenario.graderParams:null}),(0,n.jsx)(V.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:s,allowedToSeeAnswerKey:t,isCorpUser:this.props.isCorpUser,diffingResponse:this.state.lastSubmittedProblemZones,config:this.props.config,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderNERFeedback(){if(!this.state.showingSummary)return null;const e=this.canViewAnswerKey(),t=this.state.submissionResponse,s=[{name:J.DiffView.TaskerResponse,response:t&&t.processedResponse,graderResponse:e?t.graderResponse:null,graderParams:e?this.props.trainingScenario.graderParams:null},{name:J.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}];return(0,n.jsx)(W.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,name:this.props.name,showingGrade:this.state.showingGrade,trainingScenario:this.props.trainingScenario,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:s,allowedToSeeAnswerKey:e,diffingResponse:this.state.lastSubmittedProblemZones,isCorpUser:this.props.isCorpUser,trainingAttempt:this.props.trainingAttempt,backToQueue:()=>{},simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderTextCollectionFeedback(){var e;if(!this.state.showingSummary)return null;const t=this.canViewAnswerKey(),s=this.state.submissionResponse,r=[{name:J.DiffView.TaskerResponse,response:s&&s.processedResponse,isAnswerKey:!1},{name:J.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,isAnswerKey:!0}];return(0,n.jsx)(q.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,name:this.props.name,showingGrade:this.state.showingGrade,trainingScenario:this.props.trainingScenario,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:r,allowedToSeeAnswerKey:t,diffingResponse:this.state.lastSubmittedProblemZones,isCorpUser:this.props.isCorpUser,trainingAttempt:this.props.trainingAttempt,backToQueue:()=>{},loggedUserId:this.props.user.id,useProtectedText:this.props.trainingScenario.useProtectedText,project:null===(e=this.props.trainingScenario)||void 0===e?void 0:e.project,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderDocumentTranscriptionFeedback(){var e,t;if(!this.state.showingSummary)return null;const s=this.canViewAnswerKey(),r=[{name:J.DiffView.TaskerResponse,response:null===(e=this.state.submissionResponse)||void 0===e?void 0:e.processedResponse,graderResponse:s?this.state.submissionResponse.graderResponse:null,graderParams:s?this.props.trainingScenario.graderParams:null},{name:J.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}],i=null===(t=this.state.submissionResponse)||void 0===t?void 0:t.visualDiff;var a;return i&&r.unshift({name:J.DiffView.VisualDiff,response:i,graderResponse:s?this.state.submissionResponse.graderResponse:null,graderParams:s?this.props.trainingScenario.graderParams:null}),(0,n.jsx)(Q.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:r,allowedToSeeAnswerKey:s,isCorpUser:this.props.isCorpUser,diffingResponse:null!==(a=this.state.lastSubmittedProblemZones)&&void 0!==a?a:[],simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderWithWrapper(e){return(0,n.jsx)(b.ag,{children:(0,n.jsxs)("div",{className:"jsx-115bb87f811755a2 tasks__container scaler flex-column",children:[window.location.pathname.includes("/expert")?(0,n.jsx)(ce.Z,{title:"Training"}):(0,n.jsx)(w.Z,{title:"Instruction"}),(0,n.jsx)(x.Z,{}),(0,n.jsx)(y.Z,{}),(0,n.jsx)(v.Z,{}),(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(g.Z,{}),children:e}),(0,n.jsx)(i(),{id:"115bb87f811755a2",children:".flex-column.jsx-115bb87f811755a2{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}"})]})})}renderThrottlePage(){return this.renderWithWrapper((0,n.jsxs)("div",{style:{marginLeft:"25%",marginRight:"25%",marginTop:"10%",textAlign:"center"},children:[(0,n.jsx)("h2",{children:"Better luck next time"}),(0,n.jsx)("p",{children:"Unfortunately, you've run out of attempts for this scenario!"}),(0,n.jsxs)("p",{children:["You can try again in ",(0,n.jsx)("b",{children:se().duration(this.props.throttleTimeMs).humanize()})]}),(0,n.jsxs)("p",{children:["In the mean time, head on back to the"," ",(0,n.jsx)(ne.ZP,{href:"/onboarding-center",children:(0,n.jsx)("a",{href:"/onboarding-center",children:"onboarding center"})}),"!"]})]}))}render(){if(!this.props.trainingScenario)return;if(this.props.trainingScenario.taskType===O.TaskType.LidarAnnotation||this.props.trainingScenario.taskType===O.TaskType.LidarSegmentation||this.props.trainingScenario.taskType===O.TaskType.SensorFusion)return(0,n.jsx)(Se,{trainingAttemptId:this.props.trainingAttempt});const[e,t]=this.getFeedbackComponents();return d().isFinite(this.props.throttleTimeMs)?this.renderThrottlePage():this.renderWithWrapper((0,n.jsxs)(n.Fragment,{children:[e,this.renderTutorialProgress(),this.renderTutorialHighlight(),this.renderTaskPage(),(0,n.jsx)(H.Z,{showingInstructions:this.state.showingInstructions,trainingScenario:this.props.trainingScenario,startTraining:this.startTraining}),t,this.renderScenarioUpdated()]}))}constructor(e,t){super(e,t),this.updateHighlightedElement=()=>{var e,t,s;const{currentTutorialStep:n}=this.state,r=null===(e=this.props.trainingScenario)||void 0===e||null===(t=e.tutorialSteps)||void 0===t||null===(s=t[n])||void 0===s?void 0:s.highlightCSSClass;var i,a;const o=r&&(null!==(a=null!==(i=document.getElementsByClassName(r)[0])&&void 0!==i?i:document.getElementById(r))&&void 0!==a?a:document.querySelector(r));o!==this.state.highlightedElement&&this.setState({highlightedElement:o})},this.showLeaderboard=()=>this.setState({showingLeaderboard:!0}),this.hideLeaderboard=()=>this.setState({showingLeaderboard:!1}),this.showSummary=()=>this.setState({showingSummary:!0}),this.hideSummary=()=>this.setState({showingSummary:!1});var s=this;this.submitScenarioEdit=function(){var e=ke((function*(e){const t={type:s.props.trainingScenario.taskType};yield(0,R.ZP)(null,`internal/training/update/${s.props.trainingScenario._id}`,{method:"POST",query:we({},e?{isAnswerKey:1}:{}),body:t})}));return function(t){return e.apply(this,arguments)}}(),this.getOCRTextUrls=(0,ae.default)((e=>d().compact(e.map((e=>e.ocrTextUrl))))),this.transformToAssignment=(0,ae.default)(oe.Z),this.getFeedbackComponents=()=>{const e=this.props.trainingScenario.taskType;return e===O.TaskType.NamedEntityRecognition?[this.render2DScenarioHeader(),this.renderNERFeedback()]:e===O.TaskType.TextCollection?[this.render2DScenarioHeader(),this.renderTextCollectionFeedback()]:e===O.TaskType.DocumentTranscription?[this.render2DScenarioHeader(),this.renderDocumentTranscriptionFeedback()]:e===O.TaskType.Chat?[this.render2DScenarioHeader(),this.renderChatFeedback()]:[this.render2DScenarioHeader(),this.render2DFeedback()]},(0,A.Z)(this,"onSubmit","startTraining","retryTraining","waitForLoad","makeChanges","renderWithWrapper","onTutorialInteraction","getSubmitDisabledStatus","updateHighlightedElement","exit"),this.task=l.createRef()}}ve.getPageConfig=()=>({user:{authorize:function(){var e=he((function*(e){const{query:{trainingId:t,attemptId:s,edit_scenario:n,edit_answer_key:r,edit_diff:i,retry:a,view_initial_response:o},user:c}=e,d=!!c.trainerProject;if(!t&&!s)return[!1];let l;if(s)l=yield(0,R.ZP)(e,`internal/training/view/${s}`,{query:o?{with_initial_cuboids:1}:{}});else if((n||r||i)&&d){const s=yield(0,R.ZP)(e,`internal/training/edit/${t}`);l=be({},s,{trainingAttempt:i?s.trainingScenario._id:s.trainingScenario.params[r?"answerScene":"initialScene"]})}else l=yield(0,R.ZP)(e,`internal/training/begin/${t}${a?"?retry=1":""}`);return{success:!l||!(0,B.isTaskTypeLidar)(O.TaskType[l.trainingScenario.taskType])||(yield(0,le.em)({context:e})),cache:l}}));return function(t){return e.apply(this,arguments)}}(),kinds:["worker","expert"],required:!0}}),ve.getInitialProps=xe;const Se=l.memo((function(e){return l.useEffect((()=>{const t=new URLSearchParams(window.location.search),s=Object.fromEntries(t.entries()),n={sceneId:e.trainingAttemptId};s.spoof&&(n.spoof=s.spoof),window.location.href=(0,ge.vI)(n)}),[e.trainingAttemptId]),(0,n.jsx)("p",{children:"Loading LidarLite..."})}))}}]);